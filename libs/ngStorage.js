!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?module.exports=t(require("angular")):t(e.angular)}(this,function(e){"use strict";function t(t){return["$rootScope","$window","$log","$timeout",function(o,r,n,a){function i(e){var t;try{t=r[e]}catch(o){t=!1}if(t&&"localStorage"===e){var n="__"+Math.round(1e7*Math.random());try{localStorage.setItem(n,n),localStorage.removeItem(n)}catch(o){t=!1}}return t}var c,s,u=i(t)||(n.warn("This browser does not support Web Storage!"),{setItem:function(){},getItem:function(){}}),f={$default:function(t){for(var o in t)e.isDefined(f[o])||(f[o]=t[o]);return f},$reset:function(e){for(var t in f)"$"===t[0]||delete f[t]&&u.removeItem("ngStorage-"+t);return f.$default(e)}};try{u=r[t],u.length}catch(l){n.warn("This browser does not support Web Storage!"),u={}}for(var g,d=0,m=u.length;m>d;d++)(g=u.key(d))&&"ngStorage-"===g.slice(0,10)&&(f[g.slice(10)]=e.fromJson(u.getItem(g)));return c=e.copy(f),o.$watch(function(){var t;s||(s=a(function(){if(s=null,!e.equals(f,c)){t=e.copy(c),e.forEach(f,function(o,r){e.isDefined(o)&&"$"!==r[0]&&u.setItem("ngStorage-"+r,e.toJson(o)),delete t[r]});for(var o in t)u.removeItem("ngStorage-"+o);c=e.copy(f)}},100,!1))}),r.addEventListener&&r.addEventListener("storage",function(t){"ngStorage-"===t.key.slice(0,10)&&(t.newValue?f[t.key.slice(10)]=e.fromJson(t.newValue):delete f[t.key.slice(10)],c=e.copy(f),o.$apply())}),f}]}return e.module("ngStorage",[]).factory("$localStorage",t("localStorage")).factory("$sessionStorage",t("sessionStorage"))});